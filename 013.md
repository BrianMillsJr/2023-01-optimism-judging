seeu

high

# Outdated version of @openzeppelin/contracts used containing several vulnerabilities

## Summary

Outdated version of @openzeppelin/contracts used containing several vulnerabilities

## Vulnerability Detail

In [optimism/packages/contracts/package.json#L76](https://github.com/sherlock-audit/2023-01-optimism/blob/main/optimism/packages/contracts/package.json#L76) it was found an outdated version of @openzeppelin/contracts, then imported by multiple contracts.
```json
"@openzeppelin/contracts": "4.3.2"
```

## Impact

This version contains multiple high severity vulnerabilities. Some examples are:
- CVSS 7.5 [Incorrect Calculation](https://security.snyk.io/vuln/SNYK-JS-OPENZEPPELINCONTRACTS-2964946) affecting [@openzeppelin/contracts](https://security.snyk.io/package/npm/%40openzeppelin%2Fcontracts) package, versions `>=4.3.0 <4.7.2`
- CVSS 7.5 [Information Exposure](https://security.snyk.io/vuln/SNYK-JS-OPENZEPPELINCONTRACTS-2958050) affecting [@openzeppelin/contracts](https://security.snyk.io/package/npm/%40openzeppelin%2Fcontracts) package, versions `>=4.1.0 <4.7.1`
- CVSS 7.3 [Deserialization of Untrusted Data](https://security.snyk.io/vuln/SNYK-JS-OPENZEPPELINCONTRACTS-2320176) affecting [@openzeppelin/contracts](https://security.snyk.io/package/npm/%40openzeppelin%2Fcontracts) package, versions `>=3.2.0 <4.4.1`
- [Initializer reentrancy may lead to double initialization](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-9c22-pwxw-p6hx)

See more here: 
- [@openzeppelin/contracts vulnerabilities | Snyk](https://security.snyk.io/package/npm/@openzeppelin%2Fcontracts)
- [OpenZeppelin/openzeppelin-contracts/security/advisories](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories)

## Code Snippet

[optimism/packages/contracts/package.json#L76](https://github.com/sherlock-audit/2023-01-optimism/blob/main/optimism/packages/contracts/package.json#L76)
```json
"@openzeppelin/contracts": "4.3.2"
```

Here some smart contracts that import the outdated version of `@openzeppelin/contracts`:
- [optimism/packages/contracts/contracts/L2/predeploys/OVM_GasPriceOracle.sol#L5](https://github.com/sherlock-audit/2023-01-optimism-seeu-inspace/tree/main/optimism/packages/contracts/contracts/L2/predeploys/OVM_GasPriceOracle.sol#L5)
  ```Solidity
  import { Ownable } from "@openzeppelin/contracts/access/Ownable.sol";
  ```
- [optimism/packages/contracts/contracts/libraries/resolver/Lib_AddressManager.sol#L5](https://github.com/sherlock-audit/2023-01-optimism-seeu-inspace/tree/main/optimism/packages/contracts/contracts/libraries/resolver/Lib_AddressManager.sol#L5)
  ```Solidity
  import { Ownable } from "@openzeppelin/contracts/access/Ownable.sol";
  ```
- [optimism/packages/contracts/contracts/standards/IL2StandardERC20.sol#L4](https://github.com/sherlock-audit/2023-01-optimism-seeu-inspace/tree/main/optimism/packages/contracts/contracts/standards/IL2StandardERC20.sol#L4)
  ```Solidity
  import { IERC20 } from "@openzeppelin/contracts/token/ERC20/IERC20.sol";
  ```
- [optimism/packages/contracts/contracts/standards/IL2StandardERC20.sol#L5](https://github.com/sherlock-audit/2023-01-optimism-seeu-inspace/tree/main/optimism/packages/contracts/contracts/standards/IL2StandardERC20.sol#L5)
  ```Solidity
  import { IERC165 } from "@openzeppelin/contracts/utils/introspection/IERC165.sol";
  ```
- [optimism/packages/contracts/contracts/standards/L2StandardERC20.sol#L4](https://github.com/sherlock-audit/2023-01-optimism-seeu-inspace/tree/main/optimism/packages/contracts/contracts/standards/L2StandardERC20.sol#L4)
  ```Solidity
  import { ERC20 } from "@openzeppelin/contracts/token/ERC20/ERC20.sol";
  ```
- [optimism/packages/contracts/contracts/test-helpers/TestERC20.sol#L4](https://github.com/sherlock-audit/2023-01-optimism-seeu-inspace/tree/main/optimism/packages/contracts/contracts/test-helpers/TestERC20.sol#L4)
  ```Solidity
  import { ERC20 } from "@openzeppelin/contracts/token/ERC20/ERC20.sol";
  ```

## Tool used

Manual Review

## Recommendation

It is highly suggested to update `@openzeppelin/contracts` to the [most recent version, `4.8.1`](https://www.npmjs.com/package/@openzeppelin/contracts)
